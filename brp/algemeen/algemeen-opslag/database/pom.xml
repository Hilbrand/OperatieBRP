<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <artifactId>brp-algemeen-opslag</artifactId>
        <groupId>nl.bzk.brp.algemeen.opslag</groupId>
        <version>96-SNAPSHOT</version>
    </parent>
    <artifactId>brp-algemeen-opslag-database</artifactId>
    <packaging>jar</packaging>
    <name>BRP Algemeen Opslag - Database</name>
    <description>Dit project bevat de DDL om een database voor de BRP aan te kunnen maken. Tevens worden de scripts gebruikt in de ART's en unit tests om de database aan te maken.
    </description>
    <scm>
        <connection>scm:svn:https://www.modernodam.nl/svn/brp-code/trunk/algemeen/algemeen-opslag/database</connection>
      <developerConnection>scm:svn:https://www.modernodam.nl/svn/brp-code/trunk/algemeen/algemeen-opslag/brp-algemeen-opslag-database</developerConnection>
  </scm>
    <!--
     | Men kan de verschillende profiles activeren:
     | 		1) -P create-db
     |		2) -Dcreate-db=true
     |   	3) In de persoonlijke .m2/settings.xml
            4) clear-activemq om de activemq database en files te verwijderen
     |
     -->
    <properties>
        <!-- Properties die overschreven worden vanuit Jenkins/command-line -->
        <dbhost>localhost</dbhost>
        <dbprefix />
        <dbusername>brp</dbusername>
        <dbpassword>brp</dbpassword>
        <dbdriver>org.postgresql.Driver</dbdriver>
        <!-- create user brpadmin with password 'brpadmin'; alter role brpadmin with superuser;-->
        <dbadmin.username>brpadmin</dbadmin.username>
        <dbadmin.password>brpadmin</dbadmin.password>
        <!-- DB Properties -->
        <db.kern.driver>${dbdriver}</db.kern.driver>
        <db.kern.url>jdbc:postgresql://${dbhost}/${dbprefix}brp</db.kern.url>
        <db.kern.username>${dbusername}</db.kern.username>
        <db.kern.password>${dbpassword}</db.kern.password>
        <db.afnemer.driver>${dbdriver}</db.afnemer.driver>
        <db.afnemer.url>jdbc:postgresql://${dbhost}/${dbprefix}brp</db.afnemer.url>
        <db.afnemer.username>${dbusername}</db.afnemer.username>
        <db.afnemer.password>${dbpassword}</db.afnemer.password>
        <db.lev.driver>${dbdriver}</db.lev.driver>
        <db.lev.url>jdbc:postgresql://${dbhost}/${dbprefix}brp-lev</db.lev.url>
        <db.lev.username>${dbusername}</db.lev.username>
        <db.lev.password>${dbpassword}</db.lev.password>
        <db.ber.driver>${dbdriver}</db.ber.driver>
        <db.ber.url>jdbc:postgresql://${dbhost}/${dbprefix}brp-ber</db.ber.url>
        <db.ber.username>${dbusername}</db.ber.username>
        <db.ber.password>${dbpassword}</db.ber.password>
        <db.activemq.driver>${dbdriver}</db.activemq.driver>
        <db.activemq.url>jdbc:postgresql://${dbhost}/${dbprefix}activemq</db.activemq.url>
        <db.activemq.username>${dbusername}</db.activemq.username>
        <db.activemq.password>${dbpassword}</db.activemq.password>
        <!-- De default JDBC properties bedoeld voor lokaal ontwikkelen met een lokale PostgreSQL database. Voor Unit Testen
            in de Continuous Integration omgeving zijn er "ci" profiles. -->
        <maven.activemq.jdbc.url>jdbc:postgresql://${dbhost}/${dbprefix}activemq</maven.activemq.jdbc.url>
        <dbversion>${project.artifactId}-${versie}</dbversion>
        <maven.build.timestamp.format>yyyy-MM-dd HH:mm</maven.build.timestamp.format>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
        <svn.url>https://www.modernodam.nl/svn/algemeen/algemeen-opslag/trunk/database/</svn.url>
        <timestamp>${maven.build.timestamp}</timestamp>

        <docker.build.finalName>brp/database</docker.build.finalName>
    </properties>
    <dependencies>
        <dependency>
            <groupId>org.postgresql</groupId>
            <artifactId>postgresql</artifactId>
        </dependency>
    </dependencies>
    <build>
        <resources>
            <resource>
                <filtering>true</filtering>
                <directory>src/main/resources</directory>
                <includes>
                    <include>**/*</include>
                </includes>
            </resource>
        </resources>
        <testResources>
            <testResource>
                <filtering>true</filtering>
                <directory>${basedir}/src/test/resources</directory>
            </testResource>
        </testResources>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.codehaus.mojo</groupId>
                    <artifactId>sql-maven-plugin</artifactId>
                    <configuration>
                        <driver>${db.kern.driver}</driver>
                        <url>${db.kern.url}</url>
                        <username>${db.kern.username}</username>
                        <password>${db.kern.password}</password>
                    </configuration>
                </plugin>
            </plugins>
        </pluginManagement>
        <plugins>
            <plugin>
                <artifactId>maven-assembly-plugin</artifactId>
                <executions>
                    <execution>
                        <id>handmatige_database_setup</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <descriptors>
                        <descriptor>src/main/assembly/handmatige_database_setup.xml</descriptor>
                    </descriptors>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>buildnumber-maven-plugin</artifactId>
                <configuration>
                    <doCheck>false</doCheck>
                    <doUpdate>false</doUpdate>
                    <revisionOnScmFailure>onbekend</revisionOnScmFailure>
                </configuration>
                <executions>
                    <execution>
                        <goals>
                            <goal>create</goal>
                        </goals>
                        <phase>validate</phase>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>build-helper-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <id>versienummer</id>
                        <goals>
                            <goal>parse-version</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jar-plugin</artifactId>
                <version>2.4</version>
                <configuration>
                    <archive>
                        <index>true</index>
                        <manifest>
                            <addDefaultSpecificationEntries />
                        </manifest>
                        <manifestEntries>
                            <url>${svn.url}</url>
                            <version>${project.version}</version>
                            <project-name>${project.name}</project-name>
                            <artifactId>${project.artifactId}</artifactId>
                            <dbversie>${dbversion}</dbversie>
                            <model-versie>${project.version}</model-versie>
                        </manifestEntries>
                    </archive>
                </configuration>
            </plugin>
            <plugin>
                <groupId>com.agilejava.docbkx</groupId>
                <artifactId>docbkx-maven-plugin</artifactId>
                <version>${docbkx.version}</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>generate-pdf</goal>
                        </goals>
                        <phase>generate-sources</phase>
                    </execution>
                </executions>
                <dependencies>
                    <dependency>
                        <groupId>net.sf.xslthl</groupId>
                        <artifactId>xslthl</artifactId>
                        <version>2.0.1</version>
                        <scope>runtime</scope>
                    </dependency>
                </dependencies>
                <configuration>
                    <xincludeSupported>true</xincludeSupported>
                    <sectionAutolabel>true</sectionAutolabel>
                    <sectionLabelIncludesComponentLabel>true</sectionLabelIncludesComponentLabel>
                    <bodyStartIndent>0</bodyStartIndent>
                    <foCustomization>src/docbkx/docbook-fo.xsl</foCustomization>
                    <highlightSource>1</highlightSource>
                </configuration>
            </plugin>
        </plugins>
    </build>
    <profiles>
        <profile>
            <!-- Default profiel om alle BRP schema's in 1 database aan te maken -->
            <id>default</id>
            <activation>
                <property>
                    <name>ci.build</name>
                </property>
            </activation>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.liquibase</groupId>
                        <artifactId>liquibase-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>maak-brp-databases</id>
                                <phase>process-test-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>${skipTests}</skip>
                                    <dropFirst>true</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/brp-databases.xml</changeLogFile>
                                </configuration>
                            </execution>
                            <execution>
                                <id>maak-database-afnemervoorbeeld</id>
                                <phase>process-test-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>${skipTests}</skip>
                                    <dropFirst>true</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/afnemervoorbeeld.xml</changeLogFile>
                                </configuration>
                            </execution>
                            <!-- Deze execution fungeert als test voor de SQL bestanden die de proeftuin-autaut.sql genereren. -->
                            <execution>
                                <id>test-proeftuin-autaut-sqls</id>
                                <phase>process-test-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>${skipTests}</skip>
                                    <dropFirst>true</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/test-autaut-database.xml</changeLogFile>
                                </configuration>
                            </execution>
                        </executions>
                        <configuration>
                            <driver>${maven.jdbc.driverClassName}</driver>
                            <url>${maven.jdbc.url}</url>
                            <username>${maven.jdbc.username}</username>
                            <password>${maven.jdbc.password}</password>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>create-db</id>
            <activation>
                <property>
                    <name>create-db</name>
                    <value>true</value>
                </property>
            </activation>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.liquibase</groupId>
                        <artifactId>liquibase-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>maak-database</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>true</dropFirst>
                                    <changeLogFile>changeset/brp-databases.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <!-- Alles in 1 database in dit profiel -->
                                    <driver>${db.kern.driver}</driver>
                                    <url>${db.kern.url}</url>
                                    <username>${db.kern.username}</username>
                                    <password>${db.kern.password}</password>
                                </configuration>
                            </execution>
                            <execution>
                                <id>maak-afnemer-database</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>${skipTests}</skip>
                                    <dropFirst>false</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/afnemervoorbeeld.xml</changeLogFile>
                                    <driver>${db.afnemer.driver}</driver>
                                    <url>${db.afnemer.url}</url>
                                    <username>${db.afnemer.username}</username>
                                    <password>${db.afnemer.password}</password>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>clear-activemq</id>
            <activation>
                <property>
                    <name>clear-activemq</name>
                    <value>true</value>
                </property>
            </activation>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.liquibase</groupId>
                        <artifactId>liquibase-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>clear-activemq</id>
                                <phase>process-test-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>${skipTests}</skip>
                                    <dropFirst>true</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/activemq.xml</changeLogFile>
                                    <driver>${maven.jdbc.driverClassName}</driver>
                                    <url>${maven.activemq.jdbc.url}</url>
                                    <username>${maven.jdbc.username}</username>
                                    <password>${maven.jdbc.password}</password>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                    <plugin>
                        <artifactId>maven-clean-plugin</artifactId>
                        <configuration>
                            <verbose>true</verbose>
                            <filesets>
                                <fileset>
                                    <directory>/tmp/activemq-data</directory>
                                    <followSymlinks>false</followSymlinks>
                                    <includes>
                                        <include>*</include>
                                    </includes>
                                </fileset>
                            </filesets>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>maak-aparte-databases</id>
            <activation>
                <property>
                    <name>maak-databases</name>
                    <value>true</value>
                </property>
            </activation>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.liquibase</groupId>
                        <artifactId>liquibase-maven-plugin</artifactId>
                        <executions>
                            <!-- drop eerst alle schema's om 'achterblijvers' te voorkomen -->
                            <execution>
                                <id>drop-kern-schemas</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>true</dropFirst>
                                    <changeLogFile>changeset/drop-alle-schemas.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <driver>${db.kern.driver}</driver>
                                    <url>${db.kern.url}</url>
                                    <username>${db.kern.username}</username>
                                    <password>${db.kern.password}</password>
                                </configuration>
                            </execution>
                            <execution>
                                <id>drop-ber-schemas</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>true</dropFirst>
                                    <changeLogFile>changeset/drop-alle-schemas.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <driver>${db.ber.driver}</driver>
                                    <url>${db.ber.url}</url>
                                    <username>${db.ber.username}</username>
                                    <password>${db.ber.password}</password>
                                </configuration>
                            </execution>
                            <execution>
                                <id>drop-lev-schemas</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>true</dropFirst>
                                    <changeLogFile>changeset/drop-alle-schemas.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <driver>${db.lev.driver}</driver>
                                    <url>${db.lev.url}</url>
                                    <username>${db.lev.username}</username>
                                    <password>${db.lev.password}</password>
                                </configuration>
                            </execution>
                            <!-- drop eerst alle schema's om 'achterblijvers' te voorkomen -->
                            <execution>
                                <id>drop-afnemer-schemas</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>true</dropFirst>
                                    <changeLogFile>changeset/drop-alle-schemas.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <driver>${db.afnemer.driver}</driver>
                                    <url>${db.afnemer.url}</url>
                                    <username>${db.afnemer.username}</username>
                                    <password>${db.afnemer.password}</password>
                                </configuration>
                            </execution>
                            <!-- <execution>
                                 <id>drop-activemq-schemas</id>
                                 <phase>process-classes</phase>
                                 <goals>
                                     <goal>update</goal>
                                 </goals>
                                 <configuration>
                                     <dropFirst>true</dropFirst>
                                     <changeLogFile>changeset/drop-alle-schemas.xml</changeLogFile>
                                     <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                     <driver>${db.activemq.driver}</driver>
                                     <url>${db.activemq.url}</url>
                                     <username>${db.activemq.username}</username>
                                     <password>${db.activemq.password}</password>
                                 </configuration>
                             </execution>-->
                            <execution>
                                <id>maak-kern-database</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>true</dropFirst>
                                    <changeLogFile>changeset/kern-database.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <driver>${db.kern.driver}</driver>
                                    <url>${db.kern.url}</url>
                                    <username>${db.kern.username}</username>
                                    <password>${db.kern.password}</password>
                                </configuration>
                            </execution>
                            <execution>
                                <id>maak-afnemer-database</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>${skipTests}</skip>
                                    <dropFirst>true</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/afnemervoorbeeld.xml</changeLogFile>
                                    <!-- Voor nu is de afnemer database dezelfde als de kern database -->
                                    <driver>${db.afnemer.driver}</driver>
                                    <url>${db.afnemer.url}</url>
                                    <username>${db.afnemer.username}</username>
                                    <password>${db.afnemer.password}</password>
                                </configuration>
                            </execution>
                            <execution>
                                <id>maak-lev-database</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>true</dropFirst>
                                    <changeLogFile>changeset/lev-database.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <driver>${db.lev.driver}</driver>
                                    <url>${db.lev.url}</url>
                                    <username>${db.lev.username}</username>
                                    <password>${db.lev.password}</password>
                                </configuration>
                            </execution>
                            <execution>
                                <id>maak-ber-database</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>true</dropFirst>
                                    <changeLogFile>changeset/ber-database.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <driver>${db.ber.driver}</driver>
                                    <url>${db.ber.url}</url>
                                    <username>${db.ber.username}</username>
                                    <password>${db.ber.password}</password>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>generate-sql-files</id>
            <activation>
                <property>
                    <name>generate-sql-files</name>
                    <value>true</value>
                </property>
            </activation>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>sql-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>1</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>execute</goal>
                                </goals>
                                <configuration>
                                    <srcFiles>
                                        <srcFile>
                                            ${basedir}/src/main/resources/kern/helper/00-generateConstraintsAdd.sql
                                        </srcFile>
                                    </srcFiles>
                                    <printResultSet>true</printResultSet>
                                    <outputFile>${basedir}/src/main/resources/kern/helper/01-constraintsAdd.sql
                                    </outputFile>
                                </configuration>
                            </execution>
                            <execution>
                                <id>2</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>execute</goal>
                                </goals>
                                <configuration>
                                    <srcFiles>
                                        <srcFile>
                                            ${basedir}/src/main/resources/kern/helper/00-generateConstraintsDrop.sql
                                        </srcFile>
                                    </srcFiles>
                                    <printResultSet>true</printResultSet>
                                    <outputFile>${basedir}/src/main/resources/kern/helper/01-constraintsDrop.sql
                                    </outputFile>
                                </configuration>
                            </execution>
                            <execution>
                                <id>3</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>execute</goal>
                                </goals>
                                <configuration>
                                    <srcFiles>
                                        <srcFile>${basedir}/src/main/resources/kern/helper/00-generateIndexesDrop.sql
                                        </srcFile>
                                    </srcFiles>
                                    <printResultSet>true</printResultSet>
                                    <outputFile>${basedir}/src/main/resources/kern/helper/01-indexesDrop.sql
                                    </outputFile>
                                </configuration>
                            </execution>
                            <execution>
                                <id>4</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>execute</goal>
                                </goals>
                                <configuration>
                                    <srcFiles>
                                        <srcFile>${basedir}/src/main/resources/kern/helper/00-generateIndexesAdd.sql
                                        </srcFile>
                                    </srcFiles>
                                    <printResultSet>true</printResultSet>
                                    <outputFile>${basedir}/src/main/resources/kern/helper/01-indexesAdd.sql</outputFile>
                                </configuration>
                            </execution>
                            <execution>
                                <id>5</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>execute</goal>
                                </goals>
                                <configuration>
                                    <srcFiles>
                                        <srcFile>
                                            ${basedir}/src/main/resources/kern/helper/00-generateDeleteCascade.sql
                                        </srcFile>
                                    </srcFiles>
                                    <printResultSet>true</printResultSet>
                                    <outputFile>${basedir}/src/main/resources/kern/helper/93-deleteCascade.sql
                                    </outputFile>
                                </configuration>
                            </execution>
                            <execution>
                                <id>6</id>
                                <phase>process-classes</phase>
                                <goals>
                                    <goal>execute</goal>
                                </goals>
                                <configuration>
                                    <srcFiles>
                                        <srcFile>
                                            ${basedir}/src/main/resources/kern/helper/00-generateSequenceUpdate.sql
                                        </srcFile>
                                    </srcFiles>
                                    <printResultSet>true</printResultSet>
                                    <outputFile>${basedir}/src/main/resources/kern/helper/92-sequencesUpdate.sql
                                    </outputFile>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                    <!-- Deze plugin zorgt ervoor dat de gegenereerde database-aanmaken.sql-bestanden voldoen
                        aan de syntax, het stript de tekens die niet in de output thuishoren. -->
                    <plugin>
                        <groupId>com.google.code.maven-replacer-plugin</groupId>
                        <artifactId>replacer</artifactId>
                        <version>1.5.3</version>
                        <executions>
                            <execution>
                                <phase>prepare-package</phase>
                                <goals>
                                    <goal>replace</goal>
                                </goals>
                            </execution>
                        </executions>
                        <configuration>
                            <includes>
                                <include>${basedir}/src/main/resources/kern/helper/01-*.sql</include>
                                <include>${basedir}/src/main/resources/kern/helper/9?-*.sql</include>
                            </includes>
                            <replacements>
                                <replacement>
                                    <token>tempcolumn</token>
                                    <value />
                                </replacement>
                                <replacement>
                                    <token>"ALTER</token>
                                    <value>ALTER</value>
                                </replacement>
                                <replacement>
                                    <token>"CREATE</token>
                                    <value>CREATE</value>
                                </replacement>
                                <replacement>
                                    <token>"SELECT</token>
                                    <value>SELECT</value>
                                </replacement>
                                <replacement>
                                    <token>"DROP</token>
                                    <value>DROP</value>
                                </replacement>
                                <replacement>
                                    <token>;"</token>
                                    <value>;</value>
                                </replacement>
                                <replacement>
                                    <token>""</token>
                                    <value>"</value>
                                </replacement>
                                <replacement>
                                    <token>0 rows affected</token>
                                    <value />
                                </replacement>
                            </replacements>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>update-db-for-art</id>
            <activation>
                <property>
                    <name>art</name>
                    <value>true</value>
                </property>
            </activation>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.liquibase</groupId>
                        <artifactId>liquibase-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>update-database</id>
                                <phase>generate-test-sources</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <dropFirst>false</dropFirst>
                                    <changeLogFile>changeset/test-database-update.xml</changeLogFile>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <driver>${db.kern.driver}</driver>
                                    <url>${db.kern.url}</url>
                                    <username>${db.kern.username}</username>
                                    <password>${db.kern.password}</password>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>ci</id>
            <activation>
                <property>
                    <name>db.postgresql</name>
                </property>
            </activation>
            <properties>
                <!-- speciale database connectie voor archivering -->
                <maven.jdbc.archivering.url>jdbc:postgresql://${jenkins.postgresql.host}/brp_algemeen_opslag_database</maven.jdbc.archivering.url>
                <!-- connectie naar de master database om locks te leggen en wijzigingen te doen -->
                <maven.jdbc.master.url>jdbc:postgresql://${jenkins.postgresql.host}/brp_algemeen_opslag_database</maven.jdbc.master.url>
                <!-- overridden properties -->
                <maven.jdbc.url>jdbc:postgresql://${jenkins.postgresql.host}/brp_algemeen_opslag_database</maven.jdbc.url>
            </properties>
        </profile>
        <profile>
            <id>inmemory</id>
            <activation>
                <property>
                    <name>db.inmemory</name>
                </property>
            </activation>
            <properties>
                <maven.jdbc.archivering.driverClassName>org.hsqldb.jdbc.JDBCDriver</maven.jdbc.archivering.driverClassName>
                <maven.jdbc.archivering.url>jdbc:hsqldb:file:${project.build.directory}/db;shutdown=true;</maven.jdbc.archivering.url>
                <maven.jdbc.archivering.username>brp</maven.jdbc.archivering.username>
                <maven.jdbc.archivering.password>brp</maven.jdbc.archivering.password>
                <maven.jdbc.master.driverClassName>org.hsqldb.jdbc.JDBCDriver</maven.jdbc.master.driverClassName>
                <maven.jdbc.master.url>jdbc:hsqldb:file:${project.build.directory}/db;shutdown=true;</maven.jdbc.master.url>
                <maven.jdbc.master.username>brp</maven.jdbc.master.username>
                <maven.jdbc.master.password>brp</maven.jdbc.master.password>
                <maven.jdbc.driverClassName>org.hsqldb.jdbc.JDBCDriver</maven.jdbc.driverClassName>
                <maven.jdbc.url>jdbc:hsqldb:file:${project.build.directory}/db;shutdown=true;</maven.jdbc.url>
                <maven.jdbc.username>brp</maven.jdbc.username>
                <maven.jdbc.password>brp</maven.jdbc.password>
                <maven.jdbc.pool.maxActive>100</maven.jdbc.pool.maxActive>
            </properties>
            <dependencies>
                <dependency>
                    <groupId>org.hsqldb</groupId>
                    <artifactId>hsqldb</artifactId>
                    <scope>test</scope>
                </dependency>
            </dependencies>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.liquibase</groupId>
                        <artifactId>liquibase-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>maak-brp-databases</id>
                                <phase>process-test-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>${skipTests}</skip>
                                    <dropFirst>true</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/brp-hsqldb-databases.xml</changeLogFile>
                                </configuration>
                            </execution>
                            <execution>
                                <id>maak-database-afnemervoorbeeld</id>
                                <phase>process-test-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>false</skip>
                                    <dropFirst>false</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/hsql-afnemervoorbeeld.xml</changeLogFile>
                                </configuration>
                            </execution>
                            <execution>
                                <id>maak-database-activemq</id>
                                <phase>process-test-classes</phase>
                                <goals>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <skip>true</skip>
                                    <dropFirst>true</dropFirst>
                                    <promptOnNonLocalDatabase>false</promptOnNonLocalDatabase>
                                    <changeLogFile>changeset/hsql-activemq.xml</changeLogFile>
                                    <driver>${maven.jdbc.driverClassName}</driver>
                                    <url>${maven.activemq.jdbc.url}</url>
                                    <username>${maven.jdbc.username}</username>
                                    <password>${maven.jdbc.password}</password>
                                </configuration>
                            </execution>
                        </executions>
                        <configuration>
                            <driver>${maven.jdbc.driverClassName}</driver>
                            <url>${maven.jdbc.url}</url>
                            <username>${maven.jdbc.username}</username>
                            <password>${maven.jdbc.password}</password>
                        </configuration>
                        <dependencies>
                            <dependency>
                                <groupId>org.hsqldb</groupId>
                                <artifactId>hsqldb</artifactId>
                                <version>${hsqldb.version}</version>
                            </dependency>
                        </dependencies>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>docker</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-assembly-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>docker-assembly</id>
                                <phase>pre-integration-test</phase>
                            </execution>
                        </executions>
                    </plugin>
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>exec-maven-plugin</artifactId>
                        <version>1.4.0</version>
                        <executions>
                            <execution>
                                <id>docker-build</id>
                                <phase>install</phase>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>docker-publish</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>exec-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>docker-tag-image</id>
                                <phase>install</phase>
                            </execution>
                            <execution>
                                <id>docker-push-tag</id>
                                <phase>deploy</phase>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>docker-release</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>exec-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>docker-tag-image</id>
                                <phase>install</phase>
                            </execution>
                            <execution>
                                <id>docker-push-tag</id>
                                <phase>deploy</phase>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
</project>
