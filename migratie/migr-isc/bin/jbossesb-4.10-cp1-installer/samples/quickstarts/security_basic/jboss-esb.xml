<?xml version = "1.0" encoding = "UTF-8"?>
<jbossesb xmlns="http://anonsvn.labs.jboss.com/labs/jbossesb/trunk/product/etc/schemas/xml/jbossesb-1.0.1.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://anonsvn.labs.jboss.com/labs/jbossesb/trunk/product/etc/schemas/xml/jbossesb-1.0.1.xsd http://anonsvn.jboss.org/repos/labs/labs/jbossesb/trunk/product/etc/schemas/xml/jbossesb-1.0.1.xsd"
    parameterReloadSecs="5">

    <providers>
          <jms-provider name="JMSProvider" connection-factory="ConnectionFactory">
              <jms-bus busid="quickstartGwChannel">
                  <jms-message-filter dest-type="QUEUE" dest-name="queue/quickstart_securitybasic_Request_gw" />
              </jms-bus>
              <jms-bus busid="quickstartEsbChannel">
                  <jms-message-filter dest-type="QUEUE" dest-name="queue/quickstart_securitybasic_Request_esb" />
              </jms-bus>
              <jms-bus busid="quickstartEsbChannel2">
                  <jms-message-filter dest-type="QUEUE" dest-name="queue/quickstart_securitybasic_Request2_esb" />
              </jms-bus>

          </jms-provider>
			<jbr-provider name="JBR-Http" protocol="http" host="localhost">
				<jbr-bus busid="Http-1" port="9888" />
			</jbr-provider>
      </providers>

      <services>
        <service category="Security" name="SimpleListenerSecured" description="Hello World">
			<security moduleName="jbossesb"/>

            <listeners>
                <jms-listener name="JMS-Gateway" busidref="quickstartGwChannel" maxThreads="1" is-gateway="true" />
                <jms-listener name="helloWorld" busidref="quickstartEsbChannel" maxThreads="1" />

                <jbr-listener name="Http-Gateway" busidref="Http-1" is-gateway="true">
					<property name="synchronous" value="false"/>
                </jbr-listener>

            </listeners>

            <actions mep="OneWay">
					<action name="debug" class="org.jboss.soa.esb.actions.SystemPrintln">
						<property name="printfull" value="false"/>
						<property name="message" value="In Service1"/>
					</action>
                   <action name="action1" class="org.jboss.soa.esb.samples.quickstart.securitybasic.MyListenerAction" process="displayMessage"/>      

                    <!-- The next action is for Continuous Integration testing -->
                    <action name="testStore" class="org.jboss.soa.esb.actions.TestMessageStore"/>

					<!-- Route to the "Service 2" -->
					<action name="routeAction" class="org.jboss.soa.esb.actions.StaticRouter">
						<property name="destinations">
							<route-to service-category="Security" service-name="Service2"/>
						</property>
					</action>

            </actions>
        </service>

        <service category="Security" name="Service2" description="Service 2">
			<security moduleName="jbossesb"/>
            <listeners>
                <jms-listener name="helloWorld" busidref="quickstartEsbChannel2" maxThreads="1" />
            </listeners>
            <actions mep="OneWay">
				<action name="action1" class="org.jboss.soa.esb.actions.SystemPrintln">
				  <property name="printfull" value="false"/>
				  <property name="message" value="In Service2"/>
				</action>

				<action name="action2" class="org.jboss.soa.esb.samples.quickstart.securitybasic.MyListenerAction" process="displayMessage"/>      

            </actions>
        </service>

      </services>

</jbossesb>
