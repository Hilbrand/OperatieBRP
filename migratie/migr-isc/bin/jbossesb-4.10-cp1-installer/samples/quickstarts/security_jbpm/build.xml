<project name="Quickstart_security_jbpm" default="run" basedir=".">
	
	<description> 
		${ant.project.name}
		${line.separator}
	</description>

	<property name="username" value="esbuser" />
    <property name="password" value="esbpassword" />


	<!-- additional deploys
	<property name="additional.deploys" value="*.xsd"/>
	 -->

	<!-- Import the base Ant build script... -->
	<import file="../conf/base-build.xml"/>

     <target name="runtest" depends="compile" description="send esb Message to esb service">
        <echo>Send esb message to esb service</echo>
        <java fork="yes" classname="org.jboss.soa.esb.samples.quickstart.securityjbpm.test.SendEsbMessage" failonerror="true">
		<sysproperty key="log4j.configuration" value="${log4j.xml}"/>
            <arg value="ESBServiceSample"/> <!--  service category -->
            <arg value="HelloWorldStartServiceProcess"/>  <!--  service name -->
            <arg value="Hello Secured World"/> <!--  Message text -->
            <arg value="${username}"/> <!--  username text -->
            <arg value="${password}"/> <!--  password text -->
            <classpath refid="exec-classpath"/>
        </java>
    </target>

	<target name="quickstart-specific-checks" depends="assert-jbpm-secured"/>
	<target name="deployProcess" description="deploys the process definition" depends="dependencies">
		<echo>Deploy the process definition</echo>
		<taskdef name="deployToServer" classname="org.jbpm.ant.DeployProcessToServerTask">
			<classpath refid="exec-classpath"/>
		</taskdef>
		<deployToServer username="${jbpm.console.username}" password="${jbpm.console.password}" serverDeployer="${org.jboss.esb.jbpm.console.upload.url}">
			<fileset dir="${basedir}/processDefinition" includes="*"/>
		</deployToServer>
	</target>
	
	<target name="quickstart-specific-deploys">
        <copy todir="${org.jboss.esb.server.server}/conf/props" overwrite="true">
            <fileset dir="${basedir}">
                <include name="esb-users.properties"/>
                <include name="esb-roles.properties"/>
            </fileset>
        </copy>
    </target>

</project>
